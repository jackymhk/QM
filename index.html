<!DOCTYPE html>
<html>
  <head>
    <title>A Trello Dashboard</title>
    <link rel="stylesheet" media="screen" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  </head>
  <body>
    <div class="container">
      <h1>HKG81 QM</h1>
      <pre id="str"></pre>
      <div id="lists"></div>
    </div> 
  </body>

  <script src="http://code.jquery.com/jquery-1.11.3.min.js" type="text/javascript"></script>
  <script src="https://api.trello.com/1/client.js?key=8a42b4468e08ca9f165c88d1327add61"></script>
  
  <script type="text/javascript">
    var listId = ['5781353e2adfa093b77818bc'
                 ,'578277ca48b1999e7ec8e9b8'
                 //,'5780d6699daac89930dde53f'
                ];
    var allCards = [];
    var str = '';
    
    var loadLists = function() {
      for (var i = 0; i < listId.length; i++) {
        Trello.get(
          '/lists/'+listId[i]+'/cards',
         /* { cards: 'open',
            card_fields: 'name,labels'
          },*/
          loadedLists,
          function() { console.log("Failed to load lists"); }
        );
      }
     
     str = JSON.stringify(allCards, null, 2);
      $('#str').append(str);
    };
    
    var loadBoard = function() {
      //Get the users boards
      Trello.get(
        '/boards/OPFLEvqH/lists',
       /* { cards: 'open',
          card_fields: 'name,labels'
        },*/
        loadedLists,
        function() { console.log("Failed to load lists"); }
      );
    };
    
    var loadedLists = function(lists) {
      console.log("lists.legnth="+lists.length);
      allCards = allCards.concat(lists);
       
      
      
      /*
      $.each(lists, function(index, list) {
        var list_s = $("<p>" + list.name + "</p>");
        $('#lists').append(list_s);
        $.each(list.cards, function(index, card) {
          var card_s = $("<p>Card: " + card.name + "</p>");
          $('#lists').append(card_s);
        });
      });
      */
    };
    
    Trello.authorize({
      type: "popup",
      name: "HKG81 QM",
      scope: {
        read: true,
        write: false },
      expiration: "never",
      success: loadLists,
      error: function() { console.log("Failed authentication"); }
    });
  </script>
</html>
