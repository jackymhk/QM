<!DOCTYPE html>
<html>
  <head>
    <title>A Trello Dashboard</title>
    <link rel="stylesheet" media="screen" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  </head>
  <body>
    <div class="container">
      <h1>HKG81 QM</h1>
      <pre id="str"></pre>
      <div id="lists"></div>
    </div> 
  </body>

  <script src="http://code.jquery.com/jquery-1.11.3.min.js" type="text/javascript"></script>
  <script src="https://api.trello.com/1/client.js?key=8a42b4468e08ca9f165c88d1327add61"></script>
  
  <script type="text/javascript">
    var listIds = ['5781353e2adfa093b77818bc'
                 ,'578277ca48b1999e7ec8e9b8'
                 //,'5780d6699daac89930dde53f'
                ];
    var cards = [];
    var str = '';
    var count = 0;
    
    var loadLists = function() {
      for (var i = 0; i < listIds.length; i++) {
        Trello.get(
          '/lists/'+listIds[i]+'/cards',
          loadedLists,
          function() { console.log("Failed to load lists"); }
        );
      }
    };
    
    var loadedLists = function(lists) {
      cards = cards.concat(lists);
       
      count++;
      if (count == listIds.length)
        main();
    };
    
    function main() {
      str = JSON.stringify(cards, null, 2);
      $('#str').append(str);
    }
    
    Trello.authorize({
      type: "popup",
      name: "HKG81 QM",
      scope: {
        read: true,
        write: false },
      expiration: "never",
      success: loadLists,
      error: function() { console.log("Failed authentication"); }
    });
  </script>
</html>
